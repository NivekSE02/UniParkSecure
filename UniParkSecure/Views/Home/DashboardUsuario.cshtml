@using Microsoft.AspNetCore.Identity
@inject SignInManager<UniParkSecure.Models.Usuario> SignInManager
@inject UserManager<UniParkSecure.Models.Usuario> UserManager
@{
    ViewData["Title"] = "Dashboard Usuario";
    var user = await UserManager.GetUserAsync(User);
}
<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>@ViewData["Title"]</title>
<link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
<style>
    body { background:#f1f5f9; font-family:'Inter','Segoe UI',sans-serif; color:#334155; }
    .nav-shell { background:#ffffff; box-shadow:0 2px 4px rgba(0,0,0,.05); margin-bottom:30px; }
    .nav-inner { max-width:1200px; margin:0 auto; display:flex; justify-content:space-between; align-items:center; padding:14px 28px; }
    .nav-links a { text-decoration:none; font-weight:600; font-size:.9rem; padding:.55rem .9rem; border-radius:8px; color:#475569; transition:.25s; }
    .nav-links a:hover { background:#f1f5f9; color:#1e293b; }
    .nav-links a.active { background:#2563eb; color:#ffffff; box-shadow:0 2px 6px rgba(37,99,235,.35); }
    .grid-cards { display:grid; gap:22px; grid-template-columns:repeat(auto-fit,minmax(240px,1fr)); }
    .card { background:#ffffff; border:1px solid #e2e8f0; border-radius:18px; padding:24px 26px 26px; box-shadow:0 4px 14px -4px rgba(0,0,0,.08),0 2px 4px -2px rgba(0,0,0,.05); position:relative; overflow:hidden; }
    .card h3 { font-size:.75rem; font-weight:600; letter-spacing:.55px; text-transform:uppercase; color:#64748b; margin:0 0 6px; }
    .value { font-size:1.75rem; font-weight:700; letter-spacing:-.5px; color:#0f172a; line-height:1; }
    .badge { display:inline-block; padding:.35rem .65rem; font-size:.6rem; border-radius:999px; font-weight:600; letter-spacing:.5px; background:#e2fbe8; color:#047857; text-transform:uppercase; }
    form label { font-size:.75rem; font-weight:600; letter-spacing:.4px; color:#475569; }
    form input { background:#f1f5f9; border:1px solid #d0d9e3; border-radius:10px; padding:10px 12px; font-size:.85rem; width:100%; outline:none; transition:.25s; }
    form input:focus { border-color:#2563eb; background:#eef6ff; }
    .btn-primary { background:#2563eb; color:#fff; font-weight:600; font-size:.8rem; padding:.7rem 1.2rem; border-radius:10px; box-shadow:0 2px 6px rgba(37,99,235,.35); transition:.25s; }
    .btn-primary:hover { filter:brightness(1.07); }
    .btn-danger { background:#dc2626; }
    .btn-danger:hover { filter:brightness(1.07); }
    .section { background:#ffffff; border:1px solid #e2e8f0; border-radius:22px; padding:28px 30px 34px; box-shadow:0 6px 18px -6px rgba(0,0,0,.08),0 4px 10px -4px rgba(0,0,0,.05); }
</style>
</head>
<body>
<div class="nav-shell">
    <div class="nav-inner">
        <div class="nav-links flex gap-3">
            <a href="@Url.Action("DashboardUsuario","Home")" class="active">Perfil</a>
            <a href="@Url.Action("DashboardParqueosUsuario","Home")">Parqueos</a>
            <a href="@Url.Action("Historial","Registros")">Mi Historial</a>
        </div>
        <div class="flex items-center gap-4">
            <span class="text-sm font-medium text-slate-600">@user?.Email</span>
            <form asp-action="Logout" asp-controller="Account" method="post" class="m-0">
                <button type="submit" class="btn-primary btn-danger px-3 py-2 rounded-md text-xs">Cerrar sesión</button>
            </form>
        </div>
    </div>
</div>
<div class="max-w-5xl mx-auto px-6 pb-20 space-y-12">
    <header class="space-y-1">
        <h1 class="text-3xl font-extrabold tracking-tight" style="background:linear-gradient(90deg,#1e293b,#475569);-webkit-background-clip:text;color:transparent;">Bienvenido</h1>
        <p class="text-sm text-slate-500">Panel personal de gestión de datos y credenciales.</p>
    </header>

    <div class="grid-cards">
        <div class="card">
            <h3>Usuario</h3>
            <div class="value">@user?.NombreCompleto</div>
            <div class="mt-3 badge">Activo</div>
        </div>
        <div class="card">
            <h3>DUI</h3>
            <div class="value">@user?.DUI</div>
        </div>
        <div class="card">
            <h3>Correo</h3>
            <div class="value" style="font-size:1.05rem; line-height:1.2; word-break:break-all;">@user?.Email</div>
        </div>
        <div class="card">
            <h3>Matrícula</h3>
            <div class="value" style="font-size:1.4rem;">@user?.Matricula ?? "—"</div>
        </div>
    </div>

    <section class="section space-y-6">
        <h2 class="text-xl font-semibold">Actualizar Matrícula</h2>
        <form asp-action="GuardarMatricula" asp-controller="Home" method="post" class="space-y-5 max-w-md">
            <div>
                <label class="block mb-1">Matrícula</label>
                <input type="text" name="matricula" value="@user?.Matricula" placeholder="Ej: P123-456" />
            </div>
            <button type="submit" class="btn-primary">Guardar</button>
        </form>
    </section>

    <section class="section space-y-6">
        <h2 class="text-xl font-semibold">Cambiar Contraseña</h2>
        <form asp-action="CambiarPassword" asp-controller="Account" method="post" class="space-y-5 max-w-md">
            <div>
                <label class="block mb-1">Contraseña actual</label>
                <input type="password" name="oldPassword" required />
            </div>
            <div>
                <label class="block mb-1">Nueva contraseña</label>
                <input type="password" name="newPassword" required />
            </div>
            <button type="submit" class="btn-primary">Actualizar</button>
        </form>
    </section>
</div>
</body>
</html>
